<h1>{{ isEditMode ? 'Editar' : 'Nova' }} Venda</h1>

<form [formGroup]="form" (ngSubmit)="save()">
  <div>
    <label>Número da Venda:</label>
    <input formControlName="saleNumber" />
  </div>

  <div>
    <label>Data da Venda:</label>
    <input type="date" formControlName="saleDate" />
  </div>

  <div>
    <label>Cliente (ID):</label>
    <input formControlName="customerId" />
  </div>

  <div>
    <label>Filial:</label>
    <input formControlName="branch" />
  </div>

  <div>
    <label>Cancelada:</label>
    <input type="checkbox" formControlName="isCancelled" />
  </div>

  <hr />

  <h3>Itens da Venda</h3>
  <div
    formArrayName="items"
    *ngFor="let item of items.controls; let i = index"
    [formGroupName]="i"
  >
    <div>
      <label>Produto (ID):</label>
      <input formControlName="productId" />
    </div>

    <div>
      <label>Quantidade:</label>
      <input
        type="number"
        formControlName="quantity"
        (change)="onQuantityChange(i)"
      />
    </div>

    <div>
      <label>Preço Unitário:</label>
      <input type="number" formControlName="unitPrice" />
    </div>

    <div>
      <label>Desconto (%):</label>
      <input type="number" formControlName="discount" />
    </div>

    <div>
      <label>Total:</label>
      <input type="number" formControlName="totalAmount" />
    </div>

    <!-- Detalhes do Produto -->
    <fieldset formGroupName="productDetails">
      <legend>Detalhes do Produto</legend>

      <div>
        <label>Nome:</label>
        <input formControlName="title" />
      </div>

      <div>
        <label>Descrição:</label>
        <input formControlName="description" />
      </div>

      <div>
        <label>Categoria:</label>
        <input formControlName="category" />
      </div>

      <div>
        <label>Imagem:</label>
        <input formControlName="image" />
      </div>

      <div formGroupName="rating">
        <label>Nota:</label>
        <input type="number" formControlName="rate" />
        <label>Votos:</label>
        <input type="number" formControlName="count" />
      </div>
    </fieldset>

    <button type="button" (click)="removeItem(i)">Remover Item</button>
    <hr />
  </div>

  <button type="button" (click)="addItem()">Adicionar Item</button>

  <br /><br />
  <button type="submit">{{ isEditMode ? 'Atualizar' : 'Salvar' }}</button>
</form>